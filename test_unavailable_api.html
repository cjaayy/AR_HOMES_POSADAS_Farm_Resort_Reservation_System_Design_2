<!DOCTYPE html>
<html>
  <head>
    <title>Test Unavailable Dates API</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        padding: 20px;
      }
      .test-section {
        margin: 20px 0;
        padding: 15px;
        border: 1px solid #ddd;
        border-radius: 5px;
      }
      .test-section h3 {
        margin-top: 0;
      }
      .result {
        background: #f5f5f5;
        padding: 10px;
        margin: 10px 0;
        border-radius: 3px;
      }
      .blocked-date {
        display: inline-block;
        padding: 5px 10px;
        margin: 5px;
        background: #ffebee;
        border: 1px solid #f44336;
        border-radius: 3px;
      }
    </style>
  </head>
  <body>
    <h1>Test Unavailable Dates API</h1>
    <p>
      Testing if December 4 (DAYTIME booking) blocks all other package types...
    </p>

    <div id="results"></div>

    <script>
      async function testBookingType(bookingType) {
        const response = await fetch("user/get_unavailable_dates.php", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ booking_type: bookingType }),
        });

        const data = await response.json();
        return data;
      }

      async function runTests() {
        const resultsDiv = document.getElementById("results");
        const bookingTypes = ["daytime", "nighttime", "22hours"];

        for (const type of bookingTypes) {
          const result = await testBookingType(type);

          const section = document.createElement("div");
          section.className = "test-section";

          let html = `<h3>Booking Type: ${type.toUpperCase()}</h3>`;
          html += `<div class="result">`;
          html += `<strong>Success:</strong> ${result.success}<br>`;
          html += `<strong>Count:</strong> ${result.count}<br>`;
          html += `<strong>Message:</strong> ${result.message}<br>`;
          html += `<strong>Unavailable Dates:</strong><br>`;

          if (result.unavailable_dates && result.unavailable_dates.length > 0) {
            result.unavailable_dates.forEach((date) => {
              html += `<span class="blocked-date">${date}</span>`;
            });
          } else {
            html += `<em>No dates blocked</em>`;
          }

          html += `</div>`;
          section.innerHTML = html;
          resultsDiv.appendChild(section);
        }
      }

      runTests();
    </script>
  </body>
</html>
