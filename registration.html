<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      http-equiv="Cache-Control"
      content="no-cache, no-store, must-revalidate"
    />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <title>AR Homes Posadas Farm Resort - Registration</title>

    <!-- Favicon -->
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="logo/ChatGPT Image Sep 15, 2025, 10_25_25 PM.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="logo/ChatGPT Image Sep 15, 2025, 10_25_25 PM.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="logo/ChatGPT Image Sep 15, 2025, 10_25_25 PM.png"
    />
    <link
      rel="shortcut icon"
      href="logo/ChatGPT Image Sep 15, 2025, 10_25_25 PM.png"
    />

    <!-- Meta tags for better SEO and PWA support -->
    <meta name="theme-color" content="#f5c857" />
    <meta
      name="description"
      content="Register for AR Homes Posadas Farm Resort - Create your account to access premium resort reservation system."
    />
    <meta
      name="keywords"
      content="resort, registration, account, AR Homes, Posadas Farm, luxury resort"
    />
    <meta name="author" content="AR Homes Posadas Farm Resort" />

    <!-- Open Graph meta tags for social sharing -->
    <meta
      property="og:title"
      content="AR Homes Posadas Farm Resort - Registration"
    />
    <meta
      property="og:description"
      content="Create your account at AR Homes Posadas Farm Resort. Join us for luxury accommodations and world-class amenities."
    />
    <meta
      property="og:image"
      content="logo/ChatGPT Image Sep 15, 2025, 10_25_25 PM.png"
    />
    <meta property="og:url" content="#" />
    <meta property="og:type" content="website" />

    <!-- Twitter Card meta tags -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta
      name="twitter:title"
      content="AR Homes Posadas Farm Resort - Registration"
    />
    <meta
      name="twitter:description"
      content="Create your account at AR Homes Posadas Farm Resort."
    />
    <meta
      name="twitter:image"
      content="logo/ChatGPT Image Sep 15, 2025, 10_25_25 PM.png"
    />

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Dancing+Script:wght@400;500;600;700&family=Bungee+Spice&display=swap"
      rel="stylesheet"
    />

    <!-- Font Awesome for icons -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <style>
      /* Reset and Base Styles */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Poppins", sans-serif;
        min-height: 100vh;
        background: #f5c857;
        overflow-x: hidden;
      }

      /* Background slideshow (same as login page) */
      .registration-container {
        position: relative;
        min-height: 100vh;
      }

      .registration-container::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-image: url("images/545611560_1324092662718848_8811536535004180762_n.jpg");
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
        animation: backgroundSlideshow 55s infinite;
        z-index: 0;
      }

      .registration-container::after {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0);
        z-index: 1;
      }

      /* Ensure form sits above the slideshow */
      .form-container {
        position: relative;
        z-index: 2;
      }

      @keyframes backgroundSlideshow {
        0% {
          background-image: url("images/545611560_1324092662718848_8811536535004180762_n.jpg");
        }
        9% {
          background-image: url("images/545611560_1324092662718848_8811536535004180762_n.jpg");
        }
        10% {
          background-image: url("images/546182776_2167385133738763_7006991891791172725_n.jpg");
        }
        18% {
          background-image: url("images/546182776_2167385133738763_7006991891791172725_n.jpg");
        }
        19% {
          background-image: url("images/546238992_684641691315373_7119956179300816560_n.jpg");
        }
        27% {
          background-image: url("images/546238992_684641691315373_7119956179300816560_n.jpg");
        }
        28% {
          background-image: url("images/546260243_2896334557423631_287976220203457252_n.jpg");
        }
        36% {
          background-image: url("images/546260243_2896334557423631_287976220203457252_n.jpg");
        }
        37% {
          background-image: url("images/548030469_1213549567474869_7105283967168999470_n.jpg");
        }
        45% {
          background-image: url("images/548030469_1213549567474869_7105283967168999470_n.jpg");
        }
        46% {
          background-image: url("images/545601129_1082516497373944_2891607710179489901_n.jpg");
        }
        54% {
          background-image: url("images/545601129_1082516497373944_2891607710179489901_n.jpg");
        }
        55% {
          background-image: url("images/546407920_1244121977399879_5414686772811094703_n.jpg");
        }
        63% {
          background-image: url("images/546407920_1244121977399879_5414686772811094703_n.jpg");
        }
        64% {
          background-image: url("images/546908508_1509402000152429_5271822793821390970_n.jpg");
        }
        72% {
          background-image: url("images/546908508_1509402000152429_5271822793821390970_n.jpg");
        }
        73% {
          background-image: url("images/547374912_659920707160374_2419929377794463667_n.jpg");
        }
        81% {
          background-image: url("images/547374912_659920707160374_2419929377794463667_n.jpg");
        }
        82% {
          background-image: url("images/547522908_1469105141038291_1309182788430366585_n.jpg");
        }
        90% {
          background-image: url("images/547522908_1469105141038291_1309182788430366585_n.jpg");
        }
        91% {
          background-image: url("images/548337583_1787944518496349_2168279959394241583_n.jpg");
        }
        100% {
          background-image: url("images/548337583_1787944518496349_2168279959394241583_n.jpg");
        }
      }

      /* Main Container */
      .registration-container {
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        padding: 20px;
      }

      /* Header Styles */
      .header {
        text-align: center;
        margin-bottom: 30px;
        /* Make header background transparent so slideshow shows through */
        background: transparent;
        /* Remove blur so underlying image is more visible */
        backdrop-filter: none;
        padding: 20px;
        border-radius: 15px;
        /* Remove border so header does not block the background */
        border: none;
        /* Ensure header is above the registration-container overlay */
        position: relative;
        z-index: 3;
      }

      .logo-container {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 20px;
        flex-wrap: wrap;
      }

      .logo {
        width: 60px;
        height: 60px;
        border-radius: 50%;
        object-fit: cover;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
        border: 3px solid rgba(255, 255, 255, 0.3);
      }

      .system-info {
        text-align: left;
      }

      .system-name {
        font-family: "Dancing Script", cursive;
        font-size: 2.2rem;
        font-weight: 700;
        background: linear-gradient(
          180deg,
          #f8b500 0%,
          #ff6f00 35%,
          #e53935 65%,
          #6a1b9a 100%
        );
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        text-shadow: none;
        margin-bottom: 5px;
      }

      .system-subtitle {
        font-size: 1.1rem;
        color: rgba(255, 255, 255, 0.9);
        font-weight: 300;
      }

      /* Main Content */
      .main-content {
        flex: 1;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 20px 0;
      }

      .form-container {
        background: rgba(255, 255, 255, 0.05) !important;
        backdrop-filter: none;
        padding: 40px;
        border-radius: 20px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
        border: 1px solid rgba(255, 255, 255, 0.3);
        width: 100%;
        max-width: 700px;
        animation: slideUp 0.8s ease-out;
        overflow: hidden;
        box-sizing: border-box;
      }

      @keyframes slideUp {
        from {
          opacity: 0;
          transform: translateY(30px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* Form Header */
      .form-header {
        text-align: center;
        margin-bottom: 30px;
      }

      .form-header h2 {
        font-size: 2.5rem;
        font-weight: 700;
        color: #2d3748;
        margin-bottom: 10px;
      }

      .form-header p {
        font-size: 1.1rem;
        color: #718096;
        font-weight: 400;
      }

      /* Form Styles */
      .registration-form {
        display: flex;
        flex-direction: column;
        gap: 20px;
      }

      .form-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
      }

      .form-group {
        display: flex;
        flex-direction: column;
        gap: 8px;
        min-width: 0;
        width: 100%;
      }

      .form-group label {
        display: none;
      }

      .form-group label i {
        display: none;
      }

      .input-wrapper {
        position: relative;
        width: 100%;
      }

      .input-wrapper i {
        position: absolute;
        left: 15px;
        top: 50%;
        transform: translateY(-50%);
        color: #ff6f00;
        font-size: 1rem;
        pointer-events: none;
      }

      .form-input {
        padding: 15px 18px 15px 45px;
        border: 2px solid #e2e8f0;
        border-radius: 12px;
        font-size: 1rem;
        font-family: inherit;
        transition: all 0.3s ease;
        background: #ffffff !important;
        color: #2d3748;
        width: 100%;
        box-sizing: border-box;
        min-width: 0;
      }

      .form-input:focus {
        outline: none;
        border-color: #ff6f00;
        box-shadow: 0 0 0 3px rgba(255, 111, 0, 0.1);
        transform: translateY(-2px);
      }

      .form-input::placeholder {
        color: #a0aec0;
      }

      .form-input.error {
        border-color: #e53e3e;
        box-shadow: 0 0 0 3px rgba(229, 62, 62, 0.1);
      }

      /* Password Input Container */
      .password-input-container {
        position: relative;
      }

      .password-input-container > i.fa-lock {
        position: absolute;
        left: 15px;
        top: 50%;
        transform: translateY(-50%);
        color: #ff6f00;
        font-size: 1rem;
        pointer-events: none;
        z-index: 1;
      }

      .password-input-container .form-input {
        padding-left: 45px;
      }

      .password-toggle {
        position: absolute;
        right: 15px;
        top: 50%;
        transform: translateY(-50%);
        background: none;
        border: none;
        color: #718096;
        cursor: pointer;
        padding: 5px;
        border-radius: 4px;
        transition: color 0.3s ease;
      }

      .password-toggle:hover {
        color: #ff6f00;
      }

      .password-toggle:focus {
        outline: 2px solid #ff6f00;
        outline-offset: 2px;
      }

      /* Error Messages */
      .error-container {
        background: #fed7d7;
        color: #e53e3e;
        padding: 15px;
        border-radius: 8px;
        border-left: 4px solid #e53e3e;
        margin-bottom: 20px;
      }

      .error-header {
        display: flex;
        align-items: center;
        gap: 8px;
        font-weight: 600;
        margin-bottom: 10px;
      }

      .error-container ul {
        list-style: none;
        margin: 0;
        padding: 0;
      }

      .error-container li {
        margin-bottom: 5px;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .error-container li:before {
        content: "‚ö†";
        font-weight: bold;
      }

      .error-message {
        color: #e53e3e;
        font-size: 0.85rem;
        font-weight: 500;
        margin-top: 4px;
        display: block;
        min-height: 20px;
      }

      /* Register Button */
      .register-btn {
        background: linear-gradient(
          180deg,
          #f8b500 0%,
          #ff6f00 35%,
          #e53935 65%,
          #6a1b9a 100%
        );
        color: white;
        border: none;
        padding: 18px 30px;
        border-radius: 12px;
        font-size: 1.1rem;
        font-weight: 600;
        font-family: inherit;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
        margin-top: 10px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .register-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 12px 35px rgba(248, 181, 0, 0.4);
        background: linear-gradient(
          180deg,
          #e5a600 0%,
          #e56300 35%,
          #cc3030 65%,
          #5c1785 100%
        );
      }

      .register-btn:active {
        transform: translateY(-1px);
      }

      .register-btn:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        transform: none;
        box-shadow: none;
      }

      /* Login Link */
      .login-link {
        text-align: center;
        margin-top: 25px;
        padding-top: 20px;
        border-top: 1px solid #e2e8f0;
      }

      .login-link p {
        color: #718096;
        font-size: 0.95rem;
      }

      .login-link a {
        color: #ff6f00;
        text-decoration: none;
        font-weight: 600;
        transition: color 0.3s ease;
      }

      .login-link a:hover {
        color: #e53935;
        text-decoration: underline;
      }

      /* Footer */
      .footer {
        text-align: center;
        padding: 20px;
        color: rgba(255, 255, 255, 0.8);
        font-size: 0.9rem;
        margin-top: 30px;
      }

      /* Success State */
      .form-input.success {
        border-color: #38a169;
        box-shadow: 0 0 0 3px rgba(56, 161, 105, 0.1);
      }

      .success-message {
        color: #38a169;
        font-size: 0.85rem;
        font-weight: 500;
        margin-top: 4px;
        display: block;
      }

      /* Loading State */
      .register-btn.loading {
        opacity: 0.8;
        cursor: not-allowed;
      }

      .register-btn.loading i {
        animation: spin 1s linear infinite;
      }

      @keyframes spin {
        from {
          transform: rotate(0deg);
        }
        to {
          transform: rotate(360deg);
        }
      }

      @keyframes slideIn {
        from {
          opacity: 0;
          transform: translateX(50px);
        }
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }

      /* Responsive Design */
      @media (max-width: 1024px) {
        .form-container {
          max-width: 600px;
          padding: 35px 25px;
        }
      }

      @media (max-width: 900px) {
        .form-container {
          max-width: 550px;
          padding: 30px 20px;
        }

        .form-row {
          grid-template-columns: 1fr;
          gap: 15px;
        }

        .system-name {
          font-size: 2rem;
        }
      }

      @media (max-width: 1000px) and (max-height: 700px) {
        .form-row {
          grid-template-columns: 1fr;
          gap: 15px;
        }

        .form-container {
          max-width: 500px;
          padding: 25px 15px;
        }
      }

      @media (max-width: 768px) {
        .registration-container {
          padding: 15px;
        }

        .header {
          margin-bottom: 20px;
          padding: 15px;
        }

        .logo-container {
          flex-direction: column;
          gap: 15px;
        }

        .system-info {
          text-align: center;
        }

        .system-name {
          font-size: 1.8rem;
        }

        .system-subtitle {
          font-size: 1rem;
        }

        .form-container {
          padding: 25px 20px;
          margin: 0 5px;
        }

        .form-header h2 {
          font-size: 2rem;
        }

        .form-header p {
          font-size: 1rem;
        }

        .form-row {
          grid-template-columns: 1fr;
          gap: 15px;
        }

        .registration-form {
          gap: 15px;
        }

        .register-btn {
          padding: 16px 25px;
          font-size: 1rem;
        }
      }

      @media (max-width: 480px) {
        .registration-container {
          padding: 10px;
        }

        .header {
          padding: 12px;
        }

        .logo {
          width: 60px;
          height: 60px;
        }

        .system-name {
          font-size: 1.5rem;
        }

        .system-subtitle {
          font-size: 0.9rem;
        }

        .form-container {
          padding: 20px 15px;
        }

        .form-header h2 {
          font-size: 1.7rem;
        }

        .form-input {
          padding: 12px 15px;
          font-size: 0.95rem;
        }

        .register-btn {
          padding: 14px 20px;
          font-size: 0.95rem;
        }
      }

      /* High contrast mode support */
      @media (prefers-contrast: high) {
        .form-input {
          border-width: 3px;
        }

        .form-input:focus {
          box-shadow: 0 0 0 4px rgba(255, 111, 0, 0.3);
        }

        .register-btn {
          border: 2px solid transparent;
        }

        .register-btn:focus {
          outline: 3px solid #ff6f00;
          outline-offset: 2px;
        }
      }

      /* Reduced motion support */
      @media (prefers-reduced-motion: reduce) {
        * {
          animation-duration: 0.01ms !important;
          animation-iteration-count: 1 !important;
          transition-duration: 0.01ms !important;
        }

        .form-container {
          animation: none;
        }

        .form-input:focus {
          transform: none;
        }

        .register-btn:hover {
          transform: none;
        }
      }

      /* Dark mode support */
      @media (prefers-color-scheme: dark) {
        .form-container {
          background: rgba(255, 255, 255, 0.15) !important;
          color: #2d3748;
        }

        .form-header h2 {
          color: #f7fafc;
        }

        .form-header p {
          color: #cbd5e0;
        }

        .form-group label {
          color: #e2e8f0;
        }

        .form-input {
          background: #ffffff !important;
          border-color: #e2e8f0;
          color: #2d3748;
        }

        .form-input::placeholder {
          color: #a0aec0;
        }

        .form-input:focus {
          border-color: #ff6f00;
          background: #ffffff !important;
        }

        .login-link p {
          color: #cbd5e0;
        }
      }
    </style>
  </head>
  <body>
    <div class="registration-container">
      <!-- Header with Logo and System Name -->
      <header class="header">
        <div class="logo-container">
          <img
            src="logo/ChatGPT Image Sep 15, 2025, 10_25_25 PM.png"
            alt="AR Homes Posadas Farm Resort Logo"
            class="logo"
          />
          <div class="system-info">
            <h1 class="system-name">AR Homes Posadas Farm Resort</h1>
            <p class="system-subtitle">Reservation System</p>
          </div>
        </div>
      </header>

      <!-- Registration Form -->
      <main class="main-content">
        <div class="form-container">
          <div class="form-header">
            <h2>User Registration</h2>
            <p>Create your account to access our reservation system</p>
          </div>

          <!-- Error Container -->
          <div
            id="errorContainer"
            class="error-container"
            style="display: none"
          >
            <div class="error-header">
              <i class="fas fa-exclamation-circle"></i>
              <span>Please fix the following errors:</span>
            </div>
            <ul id="errorList"></ul>
          </div>

          <!-- Registration Form -->
          <form id="registrationForm" class="registration-form" novalidate>
            <!-- Name Fields Row -->
            <div class="form-row">
              <div class="form-group">
                <label for="lastName"> Last Name * </label>
                <div class="input-wrapper">
                  <i class="fas fa-user"></i>
                  <input
                    type="text"
                    id="lastName"
                    name="lastName"
                    class="form-input"
                    placeholder="Enter your last name"
                    required
                  />
                </div>
                <span id="lastNameError" class="error-message"></span>
              </div>

              <div class="form-group">
                <label for="givenName"> Given Name * </label>
                <div class="input-wrapper">
                  <i class="fas fa-user"></i>
                  <input
                    type="text"
                    id="givenName"
                    name="givenName"
                    class="form-input"
                    placeholder="Enter your given name"
                    required
                  />
                </div>
                <span id="givenNameError" class="error-message"></span>
              </div>
            </div>

            <!-- Middle Name -->
            <div class="form-group">
              <label for="middleName"> Middle Name * </label>
              <div class="input-wrapper">
                <i class="fas fa-user"></i>
                <input
                  type="text"
                  id="middleName"
                  name="middleName"
                  class="form-input"
                  placeholder="Enter your middle name"
                  required
                />
              </div>
              <span id="middleNameError" class="error-message"></span>
            </div>

            <!-- Email Address -->
            <div class="form-group">
              <label for="email"> Email Address * </label>
              <div class="input-wrapper">
                <i class="fas fa-envelope"></i>
                <input
                  type="email"
                  id="email"
                  name="email"
                  class="form-input"
                  placeholder="Enter your email address"
                  required
                />
              </div>
              <span id="emailError" class="error-message"></span>
            </div>

            <!-- Phone Number -->
            <div class="form-group">
              <label for="phoneNumber"> Phone Number * </label>
              <div class="input-wrapper">
                <i class="fas fa-phone"></i>
                <input
                  type="tel"
                  id="phoneNumber"
                  name="phoneNumber"
                  class="form-input"
                  placeholder="Enter your phone number"
                  required
                />
              </div>
              <span id="phoneNumberError" class="error-message"></span>
            </div>

            <!-- Username -->
            <div class="form-group">
              <label for="username"> Username * </label>
              <div class="input-wrapper">
                <i class="fas fa-user-circle"></i>
                <input
                  type="text"
                  id="username"
                  name="username"
                  class="form-input"
                  placeholder="Choose a username (min. 5 characters, no spaces)"
                  required
                />
              </div>
              <span id="usernameError" class="error-message"></span>
            </div>

            <!-- Password Fields Row -->
            <div class="form-row">
              <div class="form-group">
                <label for="password"> Password * </label>
                <div class="password-input-container">
                  <i class="fas fa-lock"></i>
                  <input
                    type="password"
                    id="password"
                    name="password"
                    class="form-input"
                    placeholder="Enter your password"
                    required
                  />
                  <button
                    type="button"
                    class="password-toggle"
                    id="passwordToggle"
                  >
                    <i class="fas fa-eye"></i>
                  </button>
                </div>
                <span id="passwordError" class="error-message"></span>
              </div>

              <div class="form-group">
                <label for="confirmPassword"> Confirm Password * </label>
                <div class="password-input-container">
                  <i class="fas fa-lock"></i>
                  <input
                    type="password"
                    id="confirmPassword"
                    name="confirmPassword"
                    class="form-input"
                    placeholder="Confirm your password"
                    required
                  />
                  <button
                    type="button"
                    class="password-toggle"
                    id="confirmPasswordToggle"
                  >
                    <i class="fas fa-eye"></i>
                  </button>
                </div>
                <span id="confirmPasswordError" class="error-message"></span>
              </div>
            </div>

            <!-- Submit Button -->
            <button type="submit" class="register-btn">
              <i class="fas fa-user-plus"></i>
              Register
            </button>

            <!-- Login Link -->
            <div class="login-link">
              <p>Already have an account? <a href="index.html">Login</a></p>
            </div>
          </form>
        </div>
      </main>

      <!-- Footer -->
      <footer class="footer">
        <p>&copy; 2025 AR Homes Posadas Farm Resort. All rights reserved.</p>
      </footer>
    </div>

    <!-- ALL JAVASCRIPT INLINE - NO EXTERNAL FILES, NO CACHING ISSUES -->
    <script>
      console.log("üöÄ Registration form loaded - ALL INLINE JAVASCRIPT");
      console.log("üìÖ Timestamp:", new Date().toISOString());

      // Registration Form Validation and Functionality - ALL INLINE
      document.addEventListener("DOMContentLoaded", function () {
        console.log("üìÑ DOM loaded, initializing form...");

        // Get form elements
        const form = document.getElementById("registrationForm");
        const errorContainer = document.getElementById("errorContainer");
        const errorList = document.getElementById("errorList");

        // Get input fields
        const lastName = document.getElementById("lastName");
        const givenName = document.getElementById("givenName");
        const middleName = document.getElementById("middleName");
        const email = document.getElementById("email");
        const phoneNumber = document.getElementById("phoneNumber");
        const username = document.getElementById("username");
        const password = document.getElementById("password");
        const confirmPassword = document.getElementById("confirmPassword");

        // Get password toggle buttons
        const passwordToggle = document.getElementById("passwordToggle");
        const confirmPasswordToggle = document.getElementById(
          "confirmPasswordToggle"
        );

        // Get submit button
        const submitBtn = form.querySelector(".register-btn");

        // Validation patterns
        const patterns = {
          email: /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,
          phone: /^[\+]?[0-9]{10,15}$/,
          username: /^[a-zA-Z0-9_-]{5,}$/,
          name: /^[a-zA-Z\s'-]{2,}$/,
        };

        // Error messages
        const errorMessages = {
          lastName:
            "Last name is required and must contain only letters, spaces, hyphens, or apostrophes.",
          givenName:
            "Given name is required and must contain only letters, spaces, hyphens, or apostrophes.",
          middleName:
            "Middle name is required and must contain only letters, spaces, hyphens, or apostrophes.",
          email: "Please enter a valid email address.",
          phoneNumber:
            "Phone number must be 10-15 digits and may include a + sign.",
          username:
            "Username must be at least 5 characters long and contain no spaces.",
          password: "Password is required.",
          confirmPassword: "Passwords do not match.",
          required: "This field is required.",
        };

        // Password toggle functionality
        if (passwordToggle) {
          passwordToggle.addEventListener("click", function () {
            togglePassword(password, passwordToggle);
          });
        }

        if (confirmPasswordToggle) {
          confirmPasswordToggle.addEventListener("click", function () {
            togglePassword(confirmPassword, confirmPasswordToggle);
          });
        }

        function togglePassword(inputField, toggleButton) {
          const type =
            inputField.getAttribute("type") === "password"
              ? "text"
              : "password";
          inputField.setAttribute("type", type);
          const icon = toggleButton.querySelector("i");
          icon.classList.toggle("fa-eye");
          icon.classList.toggle("fa-eye-slash");
        }

        // Add real-time validation
        addRealTimeValidation();

        // Handle form submission
        console.log("üîó Attaching submit event listener");
        form.addEventListener("submit", handleFormSubmission);
        console.log("‚úÖ Registration form ready!");

        function addRealTimeValidation() {
          const fields = [
            lastName,
            givenName,
            middleName,
            email,
            phoneNumber,
            username,
            password,
            confirmPassword,
          ];

          fields.forEach((field) => {
            field.addEventListener("blur", () => validateField(field));
            field.addEventListener("input", () => {
              if (field.classList.contains("error")) {
                validateField(field);
              }
            });
          });

          confirmPassword.addEventListener("input", validatePasswordMatch);
        }

        function validateField(field) {
          const value = field.value.trim();
          const fieldName = field.name;
          let isValid = true;
          let errorMessage = "";

          if (!value) {
            isValid = false;
            errorMessage = errorMessages.required;
          } else {
            switch (fieldName) {
              case "lastName":
              case "givenName":
              case "middleName":
                if (!patterns.name.test(value)) {
                  isValid = false;
                  errorMessage = errorMessages[fieldName];
                }
                break;
              case "email":
                if (!patterns.email.test(value)) {
                  isValid = false;
                  errorMessage = errorMessages.email;
                }
                break;
              case "phoneNumber":
                const cleanPhone = value.replace(/[\s\(\)\-]/g, "");
                if (!patterns.phone.test(cleanPhone)) {
                  isValid = false;
                  errorMessage = errorMessages.phoneNumber;
                }
                break;
              case "username":
                if (!patterns.username.test(value)) {
                  isValid = false;
                  errorMessage = errorMessages.username;
                }
                break;
              case "password":
                if (value.length < 6) {
                  isValid = false;
                  errorMessage = "Password must be at least 6 characters long.";
                }
                break;
              case "confirmPassword":
                if (value !== password.value) {
                  isValid = false;
                  errorMessage = errorMessages.confirmPassword;
                }
                break;
            }
          }

          showFieldError(field, errorMessage, !isValid);
          return isValid;
        }

        function validatePasswordMatch() {
          const isMatch = confirmPassword.value === password.value;
          if (confirmPassword.value) {
            showFieldError(
              confirmPassword,
              isMatch ? "" : errorMessages.confirmPassword,
              !isMatch
            );
          }
          return isMatch;
        }

        function showFieldError(field, message, isError) {
          const errorElement = document.getElementById(field.name + "Error");
          if (errorElement) {
            errorElement.textContent = message;
            errorElement.style.display = isError ? "block" : "none";
          }

          if (isError) {
            field.classList.add("error");
          } else {
            field.classList.remove("error");
          }
        }

        function clearFieldError(field) {
          field.classList.remove("error");
          const errorElement = document.getElementById(field.name + "Error");
          if (errorElement) {
            errorElement.textContent = "";
            errorElement.style.display = "none";
          }
        }

        function handleFormSubmission(e) {
          e.preventDefault();
          console.log("üéØ Form submitted!");

          hideErrorContainer();

          const fields = [
            lastName,
            givenName,
            middleName,
            email,
            phoneNumber,
            username,
            password,
            confirmPassword,
          ];

          let isFormValid = true;
          const errors = [];

          fields.forEach((field) => {
            if (!validateField(field)) {
              isFormValid = false;
              const fieldLabel = field.previousElementSibling.textContent
                .replace("*", "")
                .trim();
              const errorElement = document.getElementById(
                field.name + "Error"
              );
              if (errorElement && errorElement.textContent) {
                errors.push(`${fieldLabel}: ${errorElement.textContent}`);
              }
            }
          });

          if (!validatePasswordMatch()) {
            isFormValid = false;
          }

          if (!isFormValid) {
            console.log("‚ùå Form validation failed:", errors);
            showErrorContainer(errors);
            const firstErrorField = form.querySelector(".form-input.error");
            if (firstErrorField) {
              firstErrorField.scrollIntoView({
                behavior: "smooth",
                block: "center",
              });
              firstErrorField.focus();
            }
            return;
          }

          console.log("‚úÖ Form valid, sending to backend...");
          handleSuccessfulRegistration();
        }

        function showErrorContainer(errors) {
          if (errors.length === 0) return;

          errorList.innerHTML = "";
          errors.forEach((error) => {
            const li = document.createElement("li");
            li.textContent = error;
            errorList.appendChild(li);
          });

          errorContainer.style.display = "block";
          errorContainer.scrollIntoView({
            behavior: "smooth",
            block: "center",
          });
        }

        function hideErrorContainer() {
          errorContainer.style.display = "none";
          errorList.innerHTML = "";
        }

        function handleSuccessfulRegistration() {
          submitBtn.classList.add("loading");
          submitBtn.disabled = true;
          submitBtn.innerHTML =
            '<i class="fas fa-spinner fa-spin"></i> Registering...';

          const registrationData = {
            lastName: lastName.value.trim(),
            givenName: givenName.value.trim(),
            middleName: middleName.value.trim(),
            email: email.value.trim(),
            phoneNumber: phoneNumber.value.trim().replace(/[\s\(\)\-]/g, ""),
            username: username.value.trim(),
            password: password.value,
          };

          console.log("üì§ Sending registration:", registrationData);
          console.log("üìç Endpoint: user/register.php");

          fetch("user/register.php", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify(registrationData),
          })
            .then((response) => {
              console.log("üì° Response status:", response.status);
              return response.text();
            })
            .then((responseText) => {
              console.log("üìÑ Raw response:", responseText.substring(0, 200));

              let data;
              try {
                data = JSON.parse(responseText);
                console.log("üì¶ Parsed data:", data);
              } catch (e) {
                console.error("‚ùå JSON parse error:", e);
                throw new Error("Invalid JSON response");
              }

              return data;
            })
            .then((data) => {
              submitBtn.classList.remove("loading");
              submitBtn.disabled = false;
              submitBtn.innerHTML = '<i class="fas fa-user-plus"></i> Register';

              if (data.success) {
                console.log("‚úÖ SUCCESS! User saved:", data.data);

                // Disable the form to prevent resubmission
                form.style.pointerEvents = "none";
                submitBtn.disabled = true;

                showSuccessMessage();
                console.log("‚úÖ Modal displayed - waiting for user click");
                // Modal will handle redirect when user clicks
              } else {
                console.log("‚ùå Registration failed:", data.message);
                const errors = data.errors || [
                  data.message || "Registration failed.",
                ];
                showErrorContainer(errors);
              }
            })
            .catch((error) => {
              console.error("‚ùå Error:", error);
              submitBtn.classList.remove("loading");
              submitBtn.disabled = false;
              submitBtn.innerHTML = '<i class="fas fa-user-plus"></i> Register';
              showErrorContainer([
                "Network error. Please check your connection.",
              ]);
            });
        }

        function showSuccessMessage() {
          // Remove existing modal if present
          const existing = document.getElementById("verifyEmailModal");
          if (existing) existing.remove();

          const modalHtml = `
            <div id="verifyEmailModal" style="
              position: fixed;
              top: 0;
              left: 0;
              width: 100vw;
              height: 100vh;
              background: rgba(0,0,0,0.5);
              display: flex;
              align-items: center;
              justify-content: center;
              z-index: 10001;
            ">
              <div style="
                background: #fff;
                padding: 36px 30px 28px 30px;
                border-radius: 18px;
                max-width: 420px;
                width: 90vw;
                box-shadow: 0 8px 32px rgba(0,0,0,0.18);
                text-align: center;
                position: relative;
                animation: popInModal 0.3s cubic-bezier(.68,-0.55,.27,1.55);
              ">
                <div style="margin-bottom: 18px;">
                  <div style="
                    width: 60px;
                    height: 60px;
                    background: linear-gradient(180deg, #f8b500 0%, #ff6f00 35%, #e53935 65%, #6a1b9a 100%);
                    border-radius: 50%;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    margin: 0 auto 12px;
                    color: #fff;
                    font-size: 32px;
                  ">
                    <i class="fas fa-envelope"></i>
                  </div>
                  <h3 style="color: #222; margin-bottom: 8px;">Verify Your Email</h3>
                  <p style="color: #555; font-size: 1rem;">Registration successful!<br>Please check your email and verify your account before logging in.</p>
                  <p style="color: #888; font-size: 0.9rem; margin-top: 10px;">Didn't receive the email? Check your spam or junk folder.</p>
                  <p style="color: #999; font-size: 0.85rem; margin-top: 12px; font-style: italic;">Click the button below to continue</p>
                </div>
                <button id="closeModalBtn" style="
                  background: linear-gradient(180deg, #f8b500 0%, #ff6f00 35%, #e53935 65%, #6a1b9a 100%);
                  color: #fff;
                  border: none;
                  padding: 13px 36px;
                  border-radius: 8px;
                  cursor: pointer;
                  font-weight: 600;
                  font-size: 1rem;
                  margin-top: 10px;
                ">Got It!</button>
              </div>
            </div>
          `;
          document.body.insertAdjacentHTML("beforeend", modalHtml);

          // Add click handler only to the button
          document
            .getElementById("closeModalBtn")
            .addEventListener("click", function () {
              closeVerifyEmailModalAndGoLogin();
            });
        }

        // Close modal and redirect to login
        window.closeVerifyEmailModalAndGoLogin = function () {
          console.log(
            "üö™ closeVerifyEmailModalAndGoLogin called - User clicked button"
          );
          const modal = document.getElementById("verifyEmailModal");
          if (modal) {
            modal.remove();
            console.log("üóëÔ∏è Modal removed, redirecting to login...");
          }
          window.location.href = "index.html";
        };

        // Add pop-in animation for modal if not already present
        if (!document.getElementById("verifyEmailModalStyle")) {
          const style = document.createElement("style");
          style.id = "verifyEmailModalStyle";
          style.textContent = `
            @keyframes popInModal {
              0% { transform: scale(0.8); opacity: 0; }
              80% { transform: scale(1.05); opacity: 1; }
              100% { transform: scale(1); opacity: 1; }
            }
          `;
          document.head.appendChild(style);
        }
      });
    </script>
  </body>
</html>
